<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Sudoku</title>
<style>
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
  -webkit-tap-highlight-color: transparent;
}

body {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Arial, sans-serif;
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  min-height: 100vh;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 10px;
  overflow: hidden;
  position: fixed;
  width: 100%;
  height: 100%;
}

.container {
  background: rgba(255, 255, 255, 0.95);
  border-radius: 16px;
  padding: 15px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
  max-width: 500px;
  width: 100%;
}

h1 {
  text-align: center;
  color: #667eea;
  font-size: 24px;
  margin-bottom: 10px;
}

.board {
  display: grid;
  grid-template-columns: repeat(9, 1fr);
  gap: 1px;
  background: #333;
  border: 3px solid #333;
  margin: 0 auto 15px;
  max-width: 360px;
  aspect-ratio: 1;
}

.cell {
  background: white;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 18px;
  font-weight: 600;
  cursor: pointer;
  user-select: none;
  position: relative;
  aspect-ratio: 1;
}

.cell.given {
  background: #f0f0f0;
  color: #333;
  cursor: default;
}

.cell.selected {
  background: #bbdefb;
}

.cell.error {
  background: #ffcdd2;
  animation: shake 0.3s;
}

.cell.hint {
  background: #c8e6c9;
  animation: pulse 0.5s;
}

.cell:nth-child(3n):not(:nth-child(9n)) {
  border-right: 2px solid #333;
}

.cell:nth-child(n+19):nth-child(-n+27),
.cell:nth-child(n+46):nth-child(-n+54) {
  border-bottom: 2px solid #333;
}

.controls {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 8px;
  margin-bottom: 10px;
}

.btn {
  padding: 12px;
  border: none;
  border-radius: 8px;
  font-size: 14px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.2s;
  background: #667eea;
  color: white;
}

.btn:active {
  transform: scale(0.95);
}

.btn:hover {
  background: #5568d3;
}

.btn.secondary {
  background: #764ba2;
}

.btn.secondary:hover {
  background: #653a8a;
}

.numbers {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 6px;
  margin-bottom: 10px;
}

.num-btn {
  padding: 14px;
  border: 2px solid #667eea;
  border-radius: 8px;
  font-size: 18px;
  font-weight: 700;
  cursor: pointer;
  background: white;
  color: #667eea;
  transition: all 0.2s;
}

.num-btn:active {
  transform: scale(0.9);
}

.num-btn:hover {
  background: #667eea;
  color: white;
}

.modal {
  display: none;
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.7);
  align-items: center;
  justify-content: center;
  z-index: 1000;
  padding: 20px;
}

.modal.active {
  display: flex;
}

.modal-content {
  background: white;
  padding: 25px;
  border-radius: 16px;
  max-width: 400px;
  width: 100%;
  max-height: 80vh;
  overflow-y: auto;
}

.modal h2 {
  color: #667eea;
  margin-bottom: 15px;
  font-size: 22px;
}

.modal p {
  margin-bottom: 10px;
  line-height: 1.6;
  color: #333;
}

.modal ul {
  margin: 10px 0 10px 20px;
}

.modal li {
  margin-bottom: 8px;
  line-height: 1.5;
}

.close-btn {
  width: 100%;
  margin-top: 15px;
}

@keyframes shake {
  0%, 100% { transform: translateX(0); }
  25% { transform: translateX(-5px); }
  75% { transform: translateX(5px); }
}

@keyframes pulse {
  0%, 100% { transform: scale(1); }
  50% { transform: scale(1.05); }
}

@media (max-width: 400px) {
  .container {
    padding: 10px;
  }
  h1 {
    font-size: 20px;
  }
  .cell {
    font-size: 16px;
  }
  .btn {
    padding: 10px;
    font-size: 12px;
  }
  .num-btn {
    padding: 12px;
    font-size: 16px;
  }
}
</style>
</head>
<body>

<div class="container">
  <h1>üß© Sudoku</h1>
  
  <div class="board" id="board"></div>
  
  <div class="numbers" id="numbers">
    <button class="num-btn" data-num="1">1</button>
    <button class="num-btn" data-num="2">2</button>
    <button class="num-btn" data-num="3">3</button>
    <button class="num-btn" data-num="4">4</button>
    <button class="num-btn" data-num="5">5</button>
    <button class="num-btn" data-num="6">6</button>
    <button class="num-btn" data-num="7">7</button>
    <button class="num-btn" data-num="8">8</button>
    <button class="num-btn" data-num="9">9</button>
    <button class="num-btn" data-num="0">‚úï</button>
  </div>
  
  <div class="controls">
    <button class="btn" id="newBtn">New Game</button>
    <button class="btn" id="hintBtn">Hint</button>
    <button class="btn secondary" id="checkBtn">Check</button>
    <button class="btn secondary" id="solveBtn">Solve</button>
    <button class="btn" id="helpBtn">Help</button>
  </div>
</div>

<div class="modal" id="modal">
  <div class="modal-content">
    <h2>How to Play</h2>
    <p><strong>Objective:</strong> Fill the 9√ó9 grid so that each row, column, and 3√ó3 box contains the digits 1-9.</p>
    <p><strong>Controls:</strong></p>
    <ul>
      <li>Tap a cell to select it</li>
      <li>Tap a number to fill the selected cell</li>
      <li>Tap ‚úï to clear a cell</li>
      <li><strong>New Game:</strong> Start a fresh puzzle</li>
      <li><strong>Hint:</strong> Reveal one correct number</li>
      <li><strong>Check:</strong> Verify your solution</li>
      <li><strong>Solve:</strong> Show the complete solution</li>
    </ul>
    <p><strong>Tips:</strong></p>
    <ul>
      <li>Start with rows/columns that have the most numbers</li>
      <li>Look for numbers that appear frequently</li>
      <li>Eliminate possibilities systematically</li>
    </ul>
    <button class="btn close-btn" id="closeBtn">Got it!</button>
  </div>
</div>

<script>
const audioCtx = new (window.AudioContext || window.webkitAudioContext)();

function beep(freq, duration, type = 'sine') {
  const osc = audioCtx.createOscillator();
  const gain = audioCtx.createGain();
  osc.connect(gain);
  gain.connect(audioCtx.destination);
  osc.frequency.value = freq;
  osc.type = type;
  gain.gain.setValueAtTime(0.1, audioCtx.currentTime);
  gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + duration);
  osc.start(audioCtx.currentTime);
  osc.stop(audioCtx.currentTime + duration);
}

let board = [];
let solution = [];
let selected = null;
let initialBoard = [];

function generateSudoku() {
  const base = 3;
  const side = base * base;
  
  function pattern(r, c) { return (base * (r % base) + Math.floor(r / base) + c) % side; }
  function shuffle(arr) { return arr.sort(() => Math.random() - 0.5); }
  
  const rBase = [...Array(base).keys()];
  const rows = shuffle([].concat(...rBase.map(g => shuffle(rBase.map(r => g * base + r)))));
  const cols = shuffle([].concat(...rBase.map(g => shuffle(rBase.map(c => g * base + c)))));
  const nums = shuffle([...Array(side).keys()].map(n => n + 1));
  
  const grid = rows.map(r => cols.map(c => nums[pattern(r, c)]));
  
  solution = [];
  for (let r = 0; r < 9; r++) {
    solution[r] = [];
    for (let c = 0; c < 9; c++) {
      solution[r][c] = grid[r][c];
    }
  }
  
  const squares = side * side;
  const empties = Math.floor(squares * 0.5);
  
  for (let i = 0; i < empties; i++) {
    const row = Math.floor(Math.random() * side);
    const col = Math.floor(Math.random() * side);
    grid[row][col] = 0;
  }
  
  board = [];
  initialBoard = [];
  for (let r = 0; r < 9; r++) {
    board[r] = [];
    initialBoard[r] = [];
    for (let c = 0; c < 9; c++) {
      board[r][c] = grid[r][c];
      initialBoard[r][c] = grid[r][c];
    }
  }
}

function renderBoard() {
  const boardEl = document.getElementById('board');
  boardEl.innerHTML = '';
  
  const initialBoard = [];
  for (let r = 0; r < 9; r++) {
    initialBoard[r] = [];
    for (let c = 0; c < 9; c++) {
      initialBoard[r][c] = board[r][c];
    }
  }
  
  for (let r = 0; r < 9; r++) {
    for (let c = 0; c < 9; c++) {
      const cell = document.createElement('div');
      cell.className = 'cell';
      cell.dataset.row = r;
      cell.dataset.col = c;
      
      const val = board[r][c];
      if (val !== 0) {
        cell.textContent = val;
      }
      
      cell.addEventListener('click', () => selectCell(r, c));
      boardEl.appendChild(cell);
    }
  }
}

function selectCell(r, c) {
  const cells = document.querySelectorAll('.cell');
  cells.forEach(cell => cell.classList.remove('selected'));
  
  const cell = document.querySelector(`[data-row="${r}"][data-col="${c}"]`);
  const isGiven = initialBoard[r][c] !== 0;
  
  if (!isGiven) {
    cell.classList.add('selected');
    selected = { r, c };
    beep(400, 0.05);
  } else {
    selected = null;
  }
}

function placeNumber(num) {
  if (!selected) {
    beep(200, 0.1);
    return;
  }
  
  const { r, c } = selected;
  const cell = document.querySelector(`[data-row="${r}"][data-col="${c}"]`);
  
  if (initialBoard[r][c] !== 0) return;
  
  board[r][c] = num;
  cell.textContent = num === 0 ? '' : num;
  cell.classList.remove('error', 'hint');
  
  beep(num === 0 ? 300 : 600, 0.08);
  
  if (isBoardComplete() && checkSolution(false)) {
    setTimeout(() => {
      beep(800, 0.1);
      setTimeout(() => beep(1000, 0.15), 100);
      setTimeout(() => beep(1200, 0.2), 250);
      alert('üéâ Congratulations! You solved it!');
    }, 100);
  }
}

function isBoardComplete() {
  for (let r = 0; r < 9; r++) {
    for (let c = 0; c < 9; c++) {
      if (board[r][c] === 0) return false;
    }
  }
  return true;
}

function checkSolution(showAlert = true) {
  let correct = true;
  
  for (let r = 0; r < 9; r++) {
    for (let c = 0; c < 9; c++) {
      if (board[r][c] !== solution[r][c]) {
        correct = false;
        const cell = document.querySelector(`[data-row="${r}"][data-col="${c}"]`);
        if (initialBoard[r][c] === 0) {
          cell.classList.add('error');
          setTimeout(() => cell.classList.remove('error'), 1000);
        }
      }
    }
  }
  
  if (showAlert) {
    if (correct && isBoardComplete()) {
      beep(1000, 0.2);
      alert('‚úÖ Perfect! All correct!');
    } else if (correct) {
      beep(700, 0.15);
      alert('‚úÖ So far so good! Keep going!');
    } else {
      beep(200, 0.3, 'square');
      alert('‚ùå Some cells are incorrect. They are highlighted in red.');
    }
  }
  
  return correct;
}

function giveHint() {
  const empty = [];
  for (let r = 0; r < 9; r++) {
    for (let c = 0; c < 9; c++) {
      if (board[r][c] === 0 && initialBoard[r][c] === 0) {
        empty.push({ r, c });
      }
    }
  }
  
  if (empty.length === 0) {
    beep(500, 0.1);
    alert('No empty cells left!');
    return;
  }
  
  const { r, c } = empty[Math.floor(Math.random() * empty.length)];
  board[r][c] = solution[r][c];
  initialBoard[r][c] = solution[r][c];
  
  const cell = document.querySelector(`[data-row="${r}"][data-col="${c}"]`);
  cell.textContent = solution[r][c];
  cell.classList.add('hint');
  
  beep(900, 0.15);
  
  setTimeout(() => {
    cell.classList.remove('hint');
  }, 1000);
}

function solvePuzzle() {
  const userConfirmed = confirm('Are you sure you want to reveal the solution?');
  if (userConfirmed) {
    for (let r = 0; r < 9; r++) {
      for (let c = 0; c < 9; c++) {
        board[r][c] = solution[r][c];
      }
    }
    renderBoard();
    selected = null;
    beep(600, 0.1);
    setTimeout(() => beep(800, 0.15), 100);
  }
}

function newGame() {
  generateSudoku();
  renderBoard();
  selected = null;
  beep(500, 0.1);
}

document.getElementById('numbers').addEventListener('click', (e) => {
  if (e.target.classList.contains('num-btn')) {
    placeNumber(parseInt(e.target.dataset.num));
  }
});

document.getElementById('newBtn').addEventListener('click', newGame);
document.getElementById('hintBtn').addEventListener('click', giveHint);
document.getElementById('checkBtn').addEventListener('click', () => checkSolution(true));
document.getElementById('solveBtn').addEventListener('click', solvePuzzle);

document.getElementById('helpBtn').addEventListener('click', () => {
  document.getElementById('modal').classList.add('active');
  beep(600, 0.08);
});

document.getElementById('closeBtn').addEventListener('click', () => {
  document.getElementById('modal').classList.remove('active');
  beep(500, 0.08);
});

document.getElementById('modal').addEventListener('click', (e) => {
  if (e.target.id === 'modal') {
    document.getElementById('modal').classList.remove('active');
  }
});

newGame();
</script>

</body>
</html>